import{d as $,g as A,b as D,_ as G,a as J}from"./chunk-96613d34.js";import{d as I,y as F,h as m,z as q,i as E,l as x,o as f,b as z,n as l,k as d,j as N,w as H,a as w,A as O,F as R,t as j,q as y,m as k,g as U,H as K,r as P,c as S,J as Q,K as W}from"./chunk-3acec7f8.js";import{u as X}from"./chunk-3f7572c4.js";import{_ as Y}from"./chunk-fe169c68.js";import{a as Z}from"./chunk-bae47101.js";const ee=[{label:"组名",value:"name"},{label:"联系方式",value:"contact"},{label:"超级账号",value:"admin"},{label:"登录地址",value:"last_login_from"},{label:"登录时间",value:"login_time"},{label:"注册时间",value:"reg_time"}],ae={class:"table-area"},te=I({__name:"List",setup(L,{expose:h}){const v=F(()=>g.value-180),i=m([]),{width:p,height:g}=X(),b=F(()=>p.value-200),e=m({current:1,pageSize:25,total:i.value.length,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["25","50","100"],showTotal:o=>"共 "+o+" 条"}),c=F(()=>{const o=ee.map(t=>({title:t.label,dataIndex:t.value,key:t.value,width:180,fixed:void 0,sorter:!0}));return o.push({title:"操作",dataIndex:"operation",fixed:"right",width:100,key:"operation",sorter:!1}),o}),_=m({sort:"",order:""}),u=m(!1);function n(o,t,a){e.value.current=o.current,e.value.pageSize=o.pageSize,_.value.sort=a.field,_.value.order=a.order?a.order=="ascend"?"asc":"desc":a.order,r()}const s=async o=>{var a,C;const t=await $(o);((a=t==null?void 0:t.data)==null?void 0:a.status)==0?(k.success("删除成功"),r()):k.error("删除失败："+((C=t==null?void 0:t.data)==null?void 0:C.message))},r=async o=>{o&&(e.value.current=o);try{u.value=!0;let t={page:e.value.current,size:e.value.pageSize};_.value.order&&Object.assign(t,{..._.value});const a=await A(t);a.data.data&&typeof a.data.data=="object"?(u.value=!1,i.value=a.data.data,e.value.total=a.data.total):(u.value=!1,i.value=[])}catch{u.value=!1}};return q(()=>{r()}),E(()=>{}),h({getLists:r}),(o,t)=>{const a=x("a-button"),C=x("a-popconfirm"),M=x("a-table");return f(),z("div",ae,[l(M,{columns:c.value,"data-source":i.value,pagination:e.value,scroll:{x:b.value,y:v.value},loading:u.value,onChange:n},{bodyCell:d(({text:V,record:T,index:ie,column:B})=>[B.key=="operation"?(f(),N(C,{key:0,title:"确认要删除该组吗？","ok-text":"确定","cancel-text":"取消",onConfirm:()=>s(T.id)},{default:d(()=>[l(a,{type:"link",danger:"",onClick:t[0]||(t[0]=H(()=>{},["stop"]))},{default:d(()=>[w("删除")]),_:1})]),_:2},1032,["onConfirm"])):O("",!0),["admin"].includes(B.key)?(f(),z(R,{key:1},[w(j(V?"是":"否"),1)],64)):O("",!0),["login_time","reg_time"].includes(B.key)?(f(),z(R,{key:2},[w(j(y(Y).timestampToDate(V)),1)],64)):O("",!0)]),_:1},8,["columns","data-source","pagination","scroll","loading"])])}}}),oe=U(te,[["__scopeId","data-v-e47e00af"]]),se=I({__name:"createGroup",props:{isFormOpen:{type:Boolean,default:!1}},emits:["RefreshList"],setup(L,{emit:h}){const v=h,i=L,p=m(!1);K(()=>i.isFormOpen,n=>{p.value=n});const g={style:{width:"150px"}},b={span:14},e=P({name:"",password:"",contact:null}),c=m(!1),_=async()=>{var s,r;if(c.value=!0,!(e.name&&e.password)){k.error("请输入组名和密码"),c.value=!1;return}const n=await D(e);((s=n==null?void 0:n.data)==null?void 0:s.status)==0?(c.value=!1,k.success("组创建成功"),e.name="",e.password="",e.contact="",v("RefreshList",{type:"add",isShow:!1})):(c.value=!1,k.error("组创建失败："+((r=n==null?void 0:n.data)==null?void 0:r.message)))},u=()=>{e.name="",e.password="",e.contact="",c.value=!1,v("RefreshList",{type:"cancel",isShow:!1})};return(n,s)=>{const r=x("a-input"),o=x("a-form"),t=x("a-modal");return f(),N(t,{open:p.value,"onUpdate:open":s[3]||(s[3]=a=>p.value=a),title:"创建组","ok-text":"确定","cancel-text":"取消","confirm-loading":c.value,onOk:_,onCancel:u},{default:d(()=>[l(o,{model:e,"label-col":g,"wrapper-col":b},{default:d(()=>[l(r,{class:"form-input",value:e.name,"onUpdate:value":s[0]||(s[0]=a=>e.name=a),placeholder:"请输入组名"},null,8,["value"]),l(r,{class:"form-input",value:e.password,"onUpdate:value":s[1]||(s[1]=a=>e.password=a),placeholder:"请输入密码"},null,8,["value"]),l(r,{class:"form-input",value:e.contact,"onUpdate:value":s[2]||(s[2]=a=>e.contact=a),placeholder:"组联系方式"},null,8,["value"])]),_:1},8,["model"])]),_:1},8,["open","confirm-loading"])}}}),le=U(se,[["__scopeId","data-v-ed1923ea"]]),ne={class:"content"},re={style:{height:"100%"}},ce={class:"right-button"},de=I({__name:"index",setup(L){var g;const h=(g=Z.getGroup())==null?void 0:g.admin,v=m(),i=m(!1),p=({isShow:b})=>{i.value=b,v.value.getLists(1)};return(b,e)=>{const c=x("a-tab-pane"),_=x("a-tabs"),u=x("a-button");return f(),z(R,null,[l(G,null,{default:d(()=>[S("div",ne,[S("div",re,[l(_,{type:"card",size:"small"},{default:d(()=>[l(c,{key:"1"},{tab:d(()=>[S("span",null,[l(y(Q)),w("组列表")])]),default:d(()=>[l(oe,{ref_key:"listRef",ref:v},null,512)]),_:1})]),_:1}),S("div",ce,[y(h)?(f(),N(u,{key:0,type:"link",onClick:e[0]||(e[0]=n=>p({isShow:!0}))},{default:d(()=>[l(y(W),{icon:y(J),class:"icon-margin"},null,8,["icon"]),w("创建组 ")]),_:1})):O("",!0)])])])]),_:1}),l(le,{isFormOpen:i.value,onRefreshList:p},null,8,["isFormOpen"])],64)}}}),ve=U(de,[["__scopeId","data-v-c15c5d41"]]);export{ve as default};
